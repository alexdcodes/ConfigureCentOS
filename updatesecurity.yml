---
- hosts: localhost 
  tasks:
    
    - name: Update and upgrade DNF package(S) on RHET system
      become: true
      dnf:
        upgrade: yes
        update_cache: yes
        cache_valid_time: 5069 

    - name: Install Rkhunter
      become: true
      dnf:
        name: rkhunter

    - name: Install Tripwire
      become: true
      dnf:
        name: tripwire

    - name: Install Fail2ban
      become: true
      dnf:
        name: fail2ban 

    - name: Install Crowdsec
      become: true
      dnf:
        name: crowdsec

    - name: Crowdsec Status Check
      service:
        name: crowdsec
        state: started
        enabled: yes 

    - name: Fail2ban Status Check
      service:
        name: fail2ban
        state: started
        enabled: yes 
